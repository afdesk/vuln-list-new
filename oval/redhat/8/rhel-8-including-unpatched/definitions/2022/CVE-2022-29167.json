{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202229167",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2022-29167 hawk: REDoS in hawk.utils.parseHost() when parsing Host header (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-29167",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-29167"
      }
    ],
    "Description": "DOCUMENTATION: The MITRE CVE dictionary describes this issue as: Hawk is an HTTP authentication scheme providing mechanisms for making authenticated HTTP requests with partial cryptographic verification of the request and response, covering the HTTP method, request URI, host, and optionally the request payload. Hawk used a regular expression to parse `Host` HTTP header (`Hawk.utils.parseHost()`), which was subject to regular expression DoS attack - meaning each added character in the attacker's input increases the computation time exponentially. `parseHost()` was patched in `9.0.1` to use built-in `URL` class to parse hostname instead. `Hawk.authenticate()` accepts `options` argument. If that contains `host` and `port`, those would be used instead of a call to `utils.parseHost()`.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-06-01"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-29167",
          "Cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-400",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-29167",
          "Public": "20220506"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Under investigation"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "aspnetcore-targeting-pack-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231001"
                  },
                  {
                    "Comment": "aspnetcore-targeting-pack-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-sdk-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231003"
                  },
                  {
                    "Comment": "dotnet-sdk-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mozjs60-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231005"
                  },
                  {
                    "Comment": "mozjs60-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-runtime-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231007"
                  },
                  {
                    "Comment": "dotnet-runtime-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "aspnetcore-runtime-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235005"
                  },
                  {
                    "Comment": "aspnetcore-runtime-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-hostfxr-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235053"
                  },
                  {
                    "Comment": "dotnet-hostfxr-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235054"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235029"
                  },
                  {
                    "Comment": "dotnet5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-templates-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235073"
                  },
                  {
                    "Comment": "dotnet-templates-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235074"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "firefox-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812398001"
                  },
                  {
                    "Comment": "firefox-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812398002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet3.1-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231011"
                  },
                  {
                    "Comment": "dotnet3.1-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "netstandard-targeting-pack-2.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231013"
                  },
                  {
                    "Comment": "netstandard-targeting-pack-2.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "firefox is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812398003"
                  },
                  {
                    "Comment": "firefox is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812398004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "thunderbird-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812383003"
                  },
                  {
                    "Comment": "thunderbird-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812383004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-runtime-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235039"
                  },
                  {
                    "Comment": "dotnet-runtime-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231017"
                  },
                  {
                    "Comment": "dotnet is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-sdk-3.1-source-built-artifacts is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231019"
                  },
                  {
                    "Comment": "dotnet-sdk-3.1-source-built-artifacts is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mozjs60-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231021"
                  },
                  {
                    "Comment": "mozjs60-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "aspnetcore-targeting-pack-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235041"
                  },
                  {
                    "Comment": "aspnetcore-targeting-pack-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "mozjs60 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231023"
                  },
                  {
                    "Comment": "mozjs60 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-sdk-5.0-source-built-artifacts is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235057"
                  },
                  {
                    "Comment": "dotnet-sdk-5.0-source-built-artifacts is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235058"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-sdk-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235061"
                  },
                  {
                    "Comment": "dotnet-sdk-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235062"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-apphost-pack-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235065"
                  },
                  {
                    "Comment": "dotnet-apphost-pack-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235066"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet5.0-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235037"
                  },
                  {
                    "Comment": "dotnet5.0-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235038"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-templates-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231025"
                  },
                  {
                    "Comment": "dotnet-templates-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231027"
                  },
                  {
                    "Comment": "dotnet3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-targeting-pack-5.0 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20220235015"
                  },
                  {
                    "Comment": "dotnet-targeting-pack-5.0 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20220235016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-targeting-pack-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231029"
                  },
                  {
                    "Comment": "dotnet-targeting-pack-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-hostfxr-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231031"
                  },
                  {
                    "Comment": "dotnet-hostfxr-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231032"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-host is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231033"
                  },
                  {
                    "Comment": "dotnet-host is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "aspnetcore-runtime-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231035"
                  },
                  {
                    "Comment": "aspnetcore-runtime-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231036"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "thunderbird is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201812383001"
                  },
                  {
                    "Comment": "thunderbird is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201812383002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dotnet-apphost-pack-3.1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20214231037"
                  },
                  {
                    "Comment": "dotnet-apphost-pack-3.1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20214231038"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module firefox:flatpak is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:20213800015"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "firefox-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201812398001"
                          },
                          {
                            "Comment": "firefox-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201812398002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "firefox is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201812398003"
                          },
                          {
                            "Comment": "firefox is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201812398004"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module thunderbird:flatpak is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:20214231044"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "thunderbird is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201812383001"
                          },
                          {
                            "Comment": "thunderbird is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201812383002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "thunderbird-debugsource is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201812383003"
                          },
                          {
                            "Comment": "thunderbird-debugsource is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201812383004"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}